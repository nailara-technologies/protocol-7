# >:]

# name  = root.patterns.agent_output
# descr = agent startup messages and corresponding state

.: output patterns :.

  - core:/^tcp server \[[^\]]+\] launched\.$/
    [agent.change_status:<instance_id>,'online'];

  - core:/^\[(\d+)\] authentication successful \((user|agent): '(\w+)'\)$/
    [root.handler.core_session_auth:<instance_id>,<match_1>,<match_2>,<match_3>]

  - core:/^\[(\d+)\] session closed$/
    [root.handler.core_session_close:<instance_id>,<match_1>]

  - !core:/^core session id (\d+) received!$/
    [agent.set_core_sid:<instance_id>,<match_1>];

  - !core:/^instance verification string : '([a-f\d]+)'$/
    [root.handler.instance_verification_string:<instance_id>,<match_1>];
