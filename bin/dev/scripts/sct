#!/usr/bin/perl
use strict;
use warnings;
use v5.10.0;

## use script root path ## [ LLL ] ## <-- <<< ! >>>

use Time::HiRes qw| sleep |;

my @edit_files;

@ARGV = split( m|\s+|, qx| /usr/bin/xsel -o | ) if !@ARGV;

my @check_paths = qw(
    /data/projects/protocol-7/base-code
    /data/projects/protocol-7/configuration/zenki
    /data/projects/protocol-7/configuration
    /data/projects/protocol-7/bin
    /data/projects/protocol-7/bin/dev
    /data/projects/protocol-7/bin/admin
    /data/projects/protocol-7
    /data/projects/protocol-7/bin/dev/scripts
);

{
    $ENV{'HOME'} //= 'taeki';
    push( @check_paths, $ENV{'HOME'}, '/tmp' );
}

foreach my $filename (@ARGV) {
    $filename =~ s|\n||g;
    if ( $filename =~ m|^/| or -f $filename ) {
        push( @edit_files, $filename );
    } else {
        foreach my $path (@check_paths) {
            $filename = "$filename/config"
                if $path =~ m|/zenki$|
                and -d "$path/$filename"
                and -f "$path/$filename/config";
            if ( -f "$path/$filename" ) {
                push( @edit_files, "$path/$filename" );
                last;
            }
        }
    }
}

warn "\n << selected file name or path not found >>\n\n"
    if @ARGV and !@edit_files;

system( join( ' ', 'scite', @edit_files, '&' ) );
sleep 0.32;

my $xrandr_output = qx| xrandr |;
( my $sw, my $sh ) = ( $1, $2 )
    if $xrandr_output =~ m| current (\d+) x (\d+),|;

die "\n << error while acquiring screen"
    . " dimensions [ xrandr installed ? ] >>\n\n [ $xrandr_output ]"
    if not defined $sw
    or not defined $sh
    or $sw < 1
    or $sh < 1;

my $wh = $sh + 77 - 20;

system( qw| wmctrl -e |, "'0,0,-77,947,$wh'", qw| -r ' - SciTE' & | );
system(qw| wmctrl -a ' - SciTE' & |);
my $accel = 0.047;
for ( my $t = 0.97; $t > 0.77; $t -= 0.01 ) {
    qx| transset -n SciTE $t |;
    sleep $accel;
    $accel = 0.047 - sprintf( "%.04f", $accel * 0.47 );
}

#.............................................................................
#GOMPLDGFAZ4VLFTMMBNM4JEIZKXJJJLO3GZY5BGZSO35UKEPQGVBRCAZXDUQ54YU3JAVZICWCWWSK
#::: J46QCI4INWVD3EOZ2TDXAGVICRPFVZ7UXZNSLZBNNRRHIBKNVBI :::: NAILARA AMOS :::
# :: P4X7WRKH6Q4RLKV4PAWYCLWNAV4Y32NY2A63QCX2LD4AMRWIDYCY :: CODE SIGNATURE ::
# ::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
