# >:]

# name = crypt.C25519.gen_keys

my $key_name = shift // 'default';

<[base.log]>->( 2, "generating '$key_name' C25519 key pair..." );

$KEYS{'C25519'} //= {};

return warn "a C25519 key with name '$key_name' already exists!"
    if exists $KEYS{'C25519'}{$key_name};

my ( $pubkey, $privkey ) = Crypt::Ed25519::generate_keypair();

$KEYS{'C25519'}{$key_name} = {
    'name' => $key_name,
    'pub'  => $pubkey,
    'priv' => $privkey
};

return 1;
