# >:]

# name = nroot.callback.setup_agent_key

my ( $instance_id, $agent_name, $agent_key ) = @_;

my $instance_data = <nroot.agent.instance>->{$instance_id};

# take first one [ for now ]
my ($root_sid) = keys %{ $data{'session'} };
die "no valid session defined yet [ can not determine root_sid ]"
    if not defined $root_sid;

<[base.proto.nailara.command.send.local]>->(
    {   'command'   => "$root_sid.session-key",
        'call_args' => { 'args' => "$agent_name $agent_key" },
        'reply'     => {
            'handler' => 'dev.null',
            'params'  => {}
        }
    }
);

# ______________________________________________________________________________
#\\IJOQOXFTE6Q652JJEVXZ76MEQ63JS6DJXBIJKVSZOT4MSOYTHPOTUNMKRWSICABDP45H7JMXEMWZY
# \\ D6UFB7K7KQWX7NZ7QSQPOEPULBJEYUPIIFX2PF4IP5XL65J3YDQF \\// C25519-BASE-32 //
#  \\// MK4KNYT2ZPVX5PSU54L23JY4JWEINLOI6PDHHMMPDVEWWGSDEAQ \\ CODE SIGNATURE \\
#   ````````````````````````````````````````````````````````````````````````````
