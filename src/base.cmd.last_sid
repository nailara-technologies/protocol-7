# >:]

# name  = base.cmd.last_sid
# descr = returns sid of most recently connected agent

( my $last_sid ) = sort {
    $data{'session'}{$b}->{'start_time'}
        <=> $data{'session'}{$a}->{'start_time'}
} keys %{ $data{'session'} };

return {
    'mode' => 'ack',
    'data' =>
        sprintf( "%d [%s]", $last_sid, $data{'session'}{$last_sid}->{'user'} )
    }
