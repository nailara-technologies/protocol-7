#>:]

# name  = base.crypt.flush_passwords
# descr = erases all passwords / pwd hashes in memory

return if not exists <auth.pwd> and ref(<auth.pwd>) ne 'HASH';
<[base.log]>->( 0, 'flushing passwords from memory..' );
foreach my $key ( keys %{<auth.pwd>} ) {
    my $rand_len = length( <auth.pwd>->{$key} );
    substr( <auth.pwd>->{$key}, 0, $rand_len, <[base.rnd_chars]>->($rand_len) );
    <auth.pwd>->{$key} .= <[base.rnd_chars]>->( 8 + int( rand(9) ) );
}
<auth.pwd> = {};
