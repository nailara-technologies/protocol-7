# >:]

# name  = auth.auth_list

my @available;
my $id      = shift;
my @methods = split( /\s+/, <auth.supported_methods> );

foreach my $current (@methods) {

    next
        if $current eq 'unix'  # exclude 'unix' if not a unix domain socket link
        and ( not defined $id
        or $data{'handle'}{ $data{'session'}{$id}{'handle'} }{'link'} ne
        'unix' );

    push( @available, $current );
}

return join( "\n", @available, '' );
