#>:]

# name  = base.crypt.flush_passwords
# descr = erases all passwords / pwd hashes in memory

return if not exists <auth.pwd> and ref(<auth.pwd>) ne 'HASH';
[base.log:0,'flushing passwords from memory..'];
foreach my $key (keys %{<auth.pwd>}) {
  foreach my $i (0 .. int(length(<auth.pwd>->{$key}) + rand(16)) ) {
    substr(<auth.pwd>->{$key},$i,1,[base.rnd_chars_lowent:1]);
  }
}
<auth.pwd> = {};
