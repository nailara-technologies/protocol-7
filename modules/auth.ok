# >:]

# name       = auth.ok

return 0 if $_[0] eq "" or $_[1] eq "";
if ( $_[1] eq 'changemenow' ) {
    <[base.log]>->(0,
      'default password rejected. use bin/mk.usr to change it!');
    return 0;
}

my $key_ref = <[base.resolve_key]>->( 'auth.pwd.' . $_[0] );
if ( ref($key_ref) eq 'SCALAR' and ${$key_ref} eq
    <[digest.sha1]>->( $_[1] ) ) { return 1 }
else { return 0 }
