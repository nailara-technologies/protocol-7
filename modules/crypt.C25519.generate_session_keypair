## >:] ##

# name  = crypt.C25519.generate_session_keypair

my $key_name     = shift // <system.zenka.name>;
my $key_name_str = $key_name eq <system.zenka.name> ? 'zenka' : "'$key_name'";

## regenerate? <-- log level 2 [ less noise on timer interval ]
my $log_level = defined $keys{'C25519'}{'session'}{$key_name} ? 2 : 1;

<[base.log]>->( $log_level, ":[ creating $key_name_str session keys ]" );

my ( $public_key, $private_key ) = Crypt::Ed25519::generate_keypair();

my $creation_ntime = <[base.ntime.b32]>->(3);
my $key_sig
    = <[crypt.C25519.sign_data]>->( \"[$creation_ntime|$public_key]" );

return $keys{'C25519'}{'session'}{$key_name} = {
    'name'      => $key_name,
    'public'    => $public_key,
    'private'   => $private_key,
    'created'   => $creation_ntime,
    'signature' => $key_sig,
    'key-reply' => encode_b32r($public_key),
    'sig-reply' =>
        sprintf( '[%s|%s]', $creation_ntime, encode_b32r($key_sig) )
};

#,,..,,..,..,,.,.,,,.,...,.,,,.,,,...,..,,.,,,..,,...,...,...,,,.,..,,.,,,.,.,
#2REK2VPONVCFSF3WU7AH74UQWX3UYWBMNYOSYICUSZWDKAXIHTBGCZPJMYX3JOOKQP7GOTHI3ZTG2
#\\\|BNFWFLYA3VUC3GZDCIF7HNZTW2EIUOBFZNLSSSDYQXU57HB6GP4 \ / AMOS7 \ YOURUM ::
#\[7]LLFCZXEYJSJDUOKG234NUGT2OUP6VB4ACRQ37IQBJJ7HWETCDGCQ 7  DATA SIGNATURE ::
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
