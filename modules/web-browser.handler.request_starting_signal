## [:< ##

# name = web-browser.handler.request_starting_signal
# todo = implement request whitelist support ... // PORT TO WEBKIT2!!

my ( $view, $frame, $resource, $request, $response ) = @_;
( my $allowed = <web-browser.load_uri> ) =~ s{^https?://|/.*$}{}g;

## allowed ##

return 0
    if $request->get_uri =~ /:blank\]?$/
    or $request->get_uri =~ m{^https?://([^/]+\.)?\Q$allowed\E}i;

## blocked ##

<[base.log]>->(
    0, "<< ! >> <$allowed> blocked access : " . $request->get_uri
) if length( $request->get_uri );

$request->set_uri('');    # was 'about:blank' ..,

#,,,,,,.,,.,,,...,..,,.,.,...,,..,,,,,,..,..,,..,,...,...,..,,,,.,.,,,...,,,.,
#H7DNJLQ5YQ2DSWJDV3ZSDYZYSJHJRPXFT7ZFDSD5J7YWXKSQZTAQHVDAL4GMKDC7WHGBV24626DNK
#\\\|POJ7ZAJA75S6N6YJQBEVLMU5CYZ4ZD2FMYQWPWIDTC4M6N5NLYD \ / AMOS7 \ YOURUM ::
#\[7]GQMJV4HJC75UYJ75PIMBQPL7Z6MYD7LZO32THNSCUXEVTRLJMCBA 7  DATA SIGNATURE ::
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
