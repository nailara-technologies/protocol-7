## [:< ##

# name  = mod-test.cmd.list-loaded-matching
# param = <pattern>
# descr = return matching loaded perl modules [ %INC ]

my $name_pattern = $call->{'args'};

return { 'mode' => qw| false |, 'data' => 'expected name pattern' }
    if not defined $name_pattern and $name_pattern ne qw| ^ |;

$name_pattern =~ s|::|/|g;

my @loaded_mods = <[base.perlmod.get_loaded_INC_names]>;

if ( $name_pattern =~ s|^\^|| ) {
    @loaded_mods = grep { index( $ARG, $name_pattern, 0 ) == 0 } @loaded_mods;
} else {
    @loaded_mods = grep { index( $ARG, $name_pattern, 0 ) >= 0 } @loaded_mods;
}

return { 'mode' => qw| false |, 'data' => 'none match pattern' }
    if @loaded_mods == 0;

return {
    'mode' => qw| size |,
    'data' => join '',
    map {"$ARG\n"} @loaded_mods
    }

#,,.,,.,,,.,.,,,.,,.,,,,.,..,,...,,.,,,.,,,,.,..,,...,..,,..,,,.,,,,,,,,.,,.,,
#EDBNEJGP5XDH4D45NQIGJISANQ3L5RTNMDESQYXQOP5OJWQLDRR3AX43V34MSHYCVJSBKPEPUYG76
#\\\|5MBIEWD3Y2W6423I6CUB7EGRZ7VWP32UVFCGLTYZWUFBKSTJ3G2 \ / AMOS7 \ YOURUM ::
#\[7]RVAZHQW7XSCKMHTOXL32XQPI6O5VNBSQPSPY6H3XRJPYPQDH7ECA 7  DATA SIGNATURE ::
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
