# >:]

# name = root.agent.instance.restart

my $instance_id = shift;
my $instance    = <root.agent.instance>->{$instance_id};
my $agent_name  = $instance->{'agent_name'};

<[base.log]>->( 1, "restarting instance $instance_id ($agent_name)..." );

if ( exists $instance->{'status'} eq 'starting' ) {
    kill( 9, $instance->{'process'}->{'id'} );    # XXX: 15 + timeout
}
<[agent.change_status]>->( $instance_id, 'queued' );
