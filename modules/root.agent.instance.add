# >:]

# name  = root.agent.instance.add
# descr = register new agent and return its id

my $agent_id = shift || '';
die "agent id '$agent_id' does not exist!"
    if not exists <root.agent.setup>->{$agent_id};

my $instance_id = $code{'base.gen_id'}->(<root.agent.instance>);

<root.agent.instance>->{$instance_id}
    = { 'agent_id' => $agent_id, 'status' => 'offline' };

# XXX: setup defaults (and maybe watcher?)

return $instance_id;
