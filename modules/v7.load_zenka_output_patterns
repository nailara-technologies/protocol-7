## >:] ##

# name = v7.load_zenka_output_patterns

my %pattern_handlers;
my $pattern_file = shift // '';
my $zenka_name
    = <system.zenka.name> eq qw| <stdin> | ? qw| v7 | : <system.zenka.name>;

my $base_file_name = qw| zenka-output.patterns |;    # <-- << ! >>

<v7.patterns.zenka_output> //= {};

my $pattern_file_txt = $pattern_file;
$pattern_file_txt = sprintf " '%s'", $pattern_file_txt
    if length $pattern_file_txt;

my $loading_message
    = sprintf( ': loading zenka output patterns%s', $pattern_file_txt );

( my $pattern_filename = join qw| . |, $base_file_name, $pattern_file )
    =~ s|\.$||;

my $pattern_data;
my $cfg_base_path = <system.conf_path>;

{
    local <system.conf_path>    ## <-- << ! >>
        = sprintf( qw| %s/zenki/%s |, $cfg_base_path, $zenka_name );

    if ( not -f join qw| / |, <system.conf_path>, $pattern_filename ) {
        <[base.logs]>->(
            0, "zenka output-pattern file '%s' not found.",
            $pattern_filename
        );
        return;

    } else {
        <[base.log]>->( 1, $loading_message );
    }
    $pattern_data = <[base.load_section_code]>
        ->($pattern_filename)->[0]->{'output patterns'};
}

die "cannot load pattern data"
    if not defined $pattern_data
    or ref $pattern_data ne qw| ARRAY |;

<v7.pattern_config> = $pattern_data;

#,,.,,,,,,,..,,,,,,..,...,..,,,,,,,.,,...,.,.,..,,...,..,,,..,,,,,,,.,.,.,,.,,
#TG4QQT4Z4DTPFDLTB25OZWAKDKXYI4BXLVTFT6TZZNUR4O6DKABEOLOKXRHOIGC4QIJMPF7FRPO66
#\\\|YOSGHHQOBCT5A2FTPICEY42JD47CPBE2NCVAB6ZAWXCU2MWZGQ2 \ / AMOS7 \ YOURUM ::
#\[7]M7HSVMPRHIJXVIPG3QNSCGV2F4PUMFPFK4JS4ORX57CMX4A6ASBY 7  DATA SIGNATURE ::
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
