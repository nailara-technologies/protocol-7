## [:< ##

# name = io.ip.tcp.input.connect

my $fd = $_[0]->w->fd;     ## <-- $data{'session'}{$id}{'handle'} ##
my $id = $_[0]->w->data;

return undef if not defined $data{'session'}{$id};

my $client_sock_fd;
if ( ref($fd) eq qw| IO::Socket::IP | and -S $fd ) {
    if ( not $client_sock_fd = $fd->accept() ) {
        my $err_msg = <[base.format_error]>->($OS_ERROR);
        <[base.log]>->( 0, "[$id] cannot accept() connection : $err_msg" );
        return undef;
    }

    my ( $p_host, $p_port )
        = ( $client_sock_fd->peerhost(), $client_sock_fd->peerport() );

    return undef    ##  <-- closed .., ##
        if not defined $p_host
        or not defined $p_port;

    $data{'handle'}{$client_sock_fd} = {
        'encryption' => qw| none |,
        'mode'       => qw| input |,
        'link'       => qw| ip.tcp |,
        'peerhost'   => $p_host,
        'peerport'   => $p_port,
        'v4_over_6'  => $p_host =~ s|^::ffff:|| ? 1 : 0
    };

    <[base.logs]>->(
        1, '[%s] IN.-TCP [%s:%s]',
        $id,
        $data{'handle'}{$client_sock_fd}{'peerhost'},
        $data{'handle'}{$client_sock_fd}{'peerport'}
    );

    return $client_sock_fd;    ## <-- success \ returning client socket ##

} else {
    <[base.logs]>->(
        0,   '[%d] server socket is not valid %s',
        $id, <[base.caller]>
    );
    return undef;              ## <-- connection closed \ error connecting ##
}

#,,,.,,.,,.,,,..,,,,.,...,,.,,,,,,.,,,.,,,,.,,..,,...,...,.,.,..,,,.,,,..,.,.,
#LMDVG6RNRGRXHWHOCAPOBR2NLQFE4HQYWJDGYYJ5MXBAWBPOA5P4UZMCL2HHNEJ4Y6LGSUMVRQ4RA
#\\\|K7EQX7FMXGLAPLJBFLJUTX2WZC25PJBPNIE3YHDCPXIF46IZEEG \ / AMOS7 \ YOURUM ::
#\[7]BBSUQGYQO4AG6YGXRHDF4XFN4HQMDS5PS4J36WOUPLPRVW7JTCBI 7  DATA SIGNATURE ::
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
